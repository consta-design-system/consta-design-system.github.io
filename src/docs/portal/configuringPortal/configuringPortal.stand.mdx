import { MdxTabs } from '@consta/stand';
import { MdxMenu } from '@consta/stand';
import { MdxInformer } from '@consta/stand';

<MdxMenu>

- [Добавить библиотеку на Портал](#добавить-библиотеку-на-портал)
- [Добавить новую группу статей](#добавить-новую-группу-статей)
- [Добавить стенд](#добавить-стенд)
  - [Создать страницу](#создать-страницу)
  - [Настроить стенд](#настроить-стенд)
- [Запустить проект локально](#запустить-проект-локально)

</MdxMenu>

## Добавить библиотеку на Портал

Список библиотек собирается из всех репозиториев дизайн-системы на [главной странице](##LIBS) портала. Библиотеки нужно добавлять в список вручную. Контент для конкретной библиотеки обновляется в самой библиотеке.

Чтобы добавить библиотеку:

1. В репозитории библиотеки, которую нужно обновить или добавить на страницу, заполните конфигурационный файл стенда `stand/standConfig.ts` и выложите в продакшен в основную ветку (обычно это `master`).
2. Добавьте репозиторий и ветку, из которой нужно взять данные для библиотеки, в список [clone-repositories.sh](https://github.com/consta-design-system/portal/blob/master/clone-repositories.sh).

Например, так:

```tsx
git clone -b master https://${REPO_ACCESS_TOKEN}@github.com/consta-design-system/uikit.git ./repositories/uikit`
```

3. Добавьте алиас библиотеки в [webpack.config.js](https://github.com/consta-design-system/portal/blob/master/webpack.config.js) в объект `repos`:

```tsx
const repos = [
  'analytic-ui',
  'uikit',
  'charts',
  'header',
  'stats',
  'react-big-calendar-adapter',
  'gantt-task-react-adapter',
  'rc-tree-adapter',
  'rc-table-adapter',
  'ag-grid-adapter',
  'widgets',
  'amcharts-map-examples',
  'gpn-responses',
  'icons',
];
```

Это нужно для работы абсолютных путей через `##`.

Например, конструкция `##/utils/bem` в репозитории `@consta/uikit` обрабатывается как `/repositories/uikit/utils/bem`, а в `@consta/header` — как `/repositories/header/utils/bem`.

4. Соберите портал:

```tsx
# клонируйте репозитории
yarn clone-repos

# копируйте зависимости репозиториев в проект (если нужно)
yarn copy-deps

# установите зависимости
yarn install

# запустите стенд
yarn start
```

## Добавить новую группу статей

Чтобы добавить новую группу статей, добавьте группу в настройки библиотеки `src/stand/standConfig.ts` в объект `groups`:

```tsx
groups: [
  {
    title: 'Начало работы',
    id: 'startwork',
  },
];
```

## Добавить стенд

Стенд – это папка, в которой хранится вся информация по отдельной сущности дизайн-системы. Структура стендов подчиняется методологии [БЭМ](##LIBS.LIB.STAND/lib:portal/stand:contributers-componentguide):

```tsx
docs/
    Block/                              # Стенд
        Block.stand.mdx                 # Страница с текстовым описанием сущности
        Block.stand.tsx                 # Настройки стенда
```

Чтобы добавить стенд:

1. Создайте папку стенда.
2. Добавьте в папку стенда файлы с расширением:
   - `mdx` – страница стенда с текстовым описанием
   - `ts` – настройки стенда.

Подробнее о [Структуре документации](##LIBS.LIB.STAND/lib:portal/stand:portal-documentation-structure).

### Создать страницу

Чтобы создать страницу внутри раздела:

1. Перейдите в папку стенда.
2. Создайте страницу по принципу `<название_стенда>.<id_страницы>.stand.mdx`.

`id_страницы` задается в файле `standConfig.ts`:

```jsx
export const { createStand } = createConfig({
../../..
standTabs: [
    // страницы по умолчанию
    { id: '', label: 'Обзор' },
    { id: 'dev', label: 'Разработчикам' },
    { id: 'design', label: 'Дизайнерам', figma: true },
    { id: 'sandbox', label: 'Песочница', sandbox: true },
    // свои страницы
    { id: 'use', label: 'Как использовать' },
  ],
../../..
});
```

О форматировании текста на страницах стенда читайте в разделе [Форматирование текста](##LIBS.LIB.STAND/lib:portal/stand:portal-formatting-rules).

### Настроить стенд

Чтобы настроить стенд:

1. Перейдите в файл раздела с расширением `ts`.
2. Задайте настройки:

<MdxTabs labels = {['Портал', 'Библиотека компонентов']} view = "clear">
<>

```jsx
import { createStand } from '##/stand/standConfig';

export default createStand({
  title: 'О дизайн-системе',
  id: 'aboutConsta',
  group: 'startwork',
  order: 120,
  alias: ['теория', 'дизайн-система', 'зачем'],
  description: 'Что такое Consta, зачем она нужна и кому будет полезна',
});
```

Где:

- `title` – название страницы. Оно будет отображаться вверху страницы в качестве заголовка H1.
- `id` – id страницы. Используется при создании URL.
- `group` – группа (раздел), к которой принадлежит страница. Все группы разделов можно посмотреть в папке `stand` в файле `standConfig.ts`.
- `order` – порядок отображения страницы на портале. Так, чтобы отобразить страницу в первом разделе второй, задайте значение `120`.
- `alias` – ключевые слова для поиска по порталу.
- `description` – краткое описание содержимого страницы. Отображается на портале внизу названия страницы.

</>

<>

```jsx
import { createStand } from '##/stand/standConfig';

export default createStand({
  title: 'DragNDropField',
  id: 'DragNDropFieldCanary',
  group: 'components',
  description:
    'Компонент позволяет загружать файлы путем перетаскивания или через диалоговое окно',
  version: '5.3.0',
  status: 'canary',
  alias: ['поле', 'ввод', 'файл', 'файлы', 'загрузка', 'выбор'],
  figma:
    'https://www.figma.com/file/v9Jkm2GrymD277dIGpRBSH/Consta-UI-Kit?type=design&node-id=32774-0&mode=design',
  order: 10,
});
```

Где:

- `title` – название страницы. Оно будет отображаться вверху страницы в качестве заголовка H1.
- `id` – id страницы. Используется при создании URL.
- `group` – группа (раздел), к которой принадлежит страница. Все группы разделов можно посмотреть в папке `stand` в файле `standConfig.ts`.
- `order` – порядок отображения страницы на портале. Так, чтобы отобразить страницу в первом разделе второй, задайте значение `120`.

<MdxInformer status="normal">
  Компоненты и адаптеры в идут в алфавитном порядке. Для них задавать `order` не
  нужно.
</MdxInformer>

- `alias` – ключевые слова для поиска по порталу.
- `description` – краткое описание содержимого страницы. Отображается на портале внизу названия страницы.
- `version` – версия, в которой компонент стал доступен.
- `status` – статус компонента. Всего три статуса:
  - `deprecated` – устаревшая версия компонента. Будет удалён, когда версия библиотеки поднимется до мажорной.
  - `stable` – стабильная версия компонента.
  - `canary` – тестовая версия компонента. Ее можно использовать, но параметры компонента могут измениться.
- `figma` – ссылка на компонент в фигме. Обратите внимание, что ссылка должна быть в режиме `mode=design`.
- `github` – ссылка на компонент в гитхабе.

</>
</MdxTabs>

## Запустить проект локально

Чтобы запустить проект локально:

1. Установите или обновите зависимости:

```json
yarn install
```

2. Запустите сборку:

```json
yarn start
```

Полный список команд смотрите в файле `package.json`.
